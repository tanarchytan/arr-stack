name: Deploy Media Stack

on:
  push:
    branches: [ "main" ]
    paths-ignore:
      - 'README.md'
      - 'docs/**'

jobs:
  deploy:
    runs-on: self-hosted
    steps:
      - name: Update Infrastructure
        run: |
          echo "ðŸš€ Deploying to TAN-ARR..."
          
          # Navigate to the actual repo location
          cd /opt/stacks || { echo "Directory not found"; exit 1; }
          
          # Update Code
          git fetch origin main
          git reset --hard origin/main
          
          # Redeploy
          docker compose up -d --remove-orphans
          
          echo "âœ… Done."
